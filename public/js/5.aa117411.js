(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[5],{"0259":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"column content-center full-height"},[s("q-inner-loading",{attrs:{showing:e.loading}},[s("q-spinner",{attrs:{color:"primary",size:"3em"}})],1),s("div",{staticClass:"row top-bar"},[s("q-btn",{attrs:{flat:"",icon:"fas fa-arrow-left"},on:{click:function(t){return e.$router.push("/user/home")}}}),s("div",{staticClass:"q-mx-auto text-center q-my-auto text-h5"},[e._v(e._s(e.title))]),s("q-btn",{attrs:{flat:"",round:"",icon:"fas fa-info"},on:{click:function(t){e.infoDialog=!0}}})],1),s("q-scroll-area",{ref:"scrollArea",staticStyle:{height:"85vh",width:"100%","max-width":"500px"},attrs:{"thumb-style":e.thumbStyle}},[s("div",{staticClass:"q-pa-md row justify-center"},e._l(e.messages,(function(t){return s("div",{key:t.index,staticStyle:{width:"100%"}},[t.userName===e.fullName?s("q-chat-message",{attrs:{text:[t.msg],sent:"",stamp:t.time}}):s("q-chat-message",{attrs:{text:[t.msg],"bg-color":"accent",name:t.userName,stamp:t.time}})],1)})),0)]),s("q-input",{staticClass:"fixed-bottom q-mx-auto q-ma-xs",staticStyle:{"max-width":"500px"},attrs:{filled:"",placeholder:"Type a message..."},on:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.send(t)}},scopedSlots:e._u([{key:"after",fn:function(){return[s("q-btn",{attrs:{flat:"",icon:"fas fa-paper-plane",color:"primary"},on:{click:e.send}})]},proxy:!0}]),model:{value:e.message,callback:function(t){e.message=t},expression:"message"}}),s("q-dialog",{model:{value:e.infoDialog,callback:function(t){e.infoDialog=t},expression:"infoDialog"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center q-pb-none"},[s("div",{staticClass:"text-h6"},[e._v("Info")]),s("q-space"),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),s("q-card-section",[s("q-btn-dropdown",{attrs:{color:"secondary",label:"Settings","dropdown-icon":"fas fa-cog"}},[s("q-list",[s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.delMsgDialog=!0}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"far fa-trash-alt"}})],1),s("q-item-section",[s("q-item-label",{staticClass:"text-red"},[e._v("Delete Messages")])],1)],1),s("q-item",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{clickable:""},on:{click:function(t){e.delConvDialog=!0}}},[s("q-item-section",{attrs:{avatar:""}},[s("q-icon",{attrs:{color:"red",name:"far fa-trash-alt"}})],1),s("q-item-section",[s("q-item-label",{staticClass:"text-red"},[e._v("Delete Conversation")])],1)],1)],1)],1)],1)],1)],1),s("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.delMsgDialog,callback:function(t){e.delMsgDialog=t},expression:"delMsgDialog"}},[s("q-card",{staticClass:"bg-red text-white",staticStyle:{width:"300px"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("Delete Messages")])]),s("q-card-section",{staticClass:"q-pt-none"},[e._v("Are you sure you want to delete this conversation messages?")]),s("q-card-actions",{staticClass:"bg-white text-teal",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-green",attrs:{flat:"",label:"Cancel"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-red",attrs:{flat:"",label:"Delete"},on:{click:function(t){return e.delMsg()}}})],1)],1)],1),s("q-dialog",{attrs:{persistent:"","transition-show":"scale","transition-hide":"scale"},model:{value:e.delConvDialog,callback:function(t){e.delConvDialog=t},expression:"delConvDialog"}},[s("q-card",{staticClass:"bg-red text-white",staticStyle:{width:"300px"}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("Delete Conversation")])]),s("q-card-section",{staticClass:"q-pt-none"},[e._v("Are you sure you want to delete this conversation")]),s("q-card-actions",{staticClass:"bg-white",attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-green",attrs:{flat:"",label:"Cancel"}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"text-red",attrs:{flat:"",label:"Delete"},on:{click:e.delConv}})],1)],1)],1)],1)},o=[],i=s("c973"),n=s.n(i),r=s("bd4c"),l=s("30ca"),c=s.n(l),m={data(){return{message:"",socket:null,messages:[],room:null,thumbStyle:{right:"2px",borderRadius:"5px",backgroundColor:"#e51467",width:"5px",opacity:.75},infoDialog:!1,delMsgDialog:!1,delConvDialog:!1,loading:!1}},created(){var e=this;return n()((function*(){e.loading=!0;const t=yield e.$axios.get("/api/rooms/room/"+e.$route.params.roomId);e.room=t.data,e.messages=t.data.messages,e.loading=!1,e.socket=c()(),e.socket.emit("joinRoom",{room:e.room.id}),e.socket.on("message",({msg:t,userName:s,time:a})=>{e.messages.push({msg:t,userName:s,time:a})}),e.socket.on("info",t=>e.$q.notify({message:t,color:"primary"}))}))()},methods:{send(){if(this.message){let e=Date.now(),t=r["b"].formatDate(e,"ddd-H:mm");const s={msg:this.message,room:this.room.id,userName:this.fullName,time:t};this.socket.emit("message",s),this.messages.push(s),this.message="",this.$refs.scrollArea.setScrollPosition(100*this.messages.length,300)}},delMsg(){this.$axios.delete("/api/rooms/messages/"+this.$route.params.roomId).then(e=>{200==e.status&&(this.$q.notify({message:"Messages deleted",color:"positive"}),this.messages=[])}).catch(e=>{e&&this.$q.notify({message:"Something went wrong",color:"negative"})})},delConv(){this.$axios.delete("/api/rooms/"+this.$route.params.roomId).then(e=>{200==e.status&&200==e.status&&(this.$q.notify({message:"Conversation Deleted",color:"positive"}),this.$router.push("/user/home"))}).catch(e=>{this.$q.notify({message:"Something went wrong",color:"negative"})})}},computed:{fullName(){return this.$store.getters["chatStore/getFullName"]},title(){return this.room?this.room.roomName:""}}},d=m,p=s("2877"),u=s("74f7"),g=s("0d59"),h=s("9c40"),f=s("4983"),v=s("8169"),q=s("27f9"),b=s("24e8"),w=s("f09f"),x=s("a370"),C=s("2c91"),y=s("f20b"),k=s("1c1c"),D=s("66e5"),S=s("4074"),N=s("0016"),Q=s("0170"),$=s("4b7e"),_=s("7f67"),M=s("eebe"),I=s.n(M),A=Object(p["a"])(d,a,o,!1,null,"f068a16c",null);t["default"]=A.exports;I()(A,"components",{QInnerLoading:u["a"],QSpinner:g["a"],QBtn:h["a"],QScrollArea:f["a"],QChatMessage:v["a"],QInput:q["a"],QDialog:b["a"],QCard:w["a"],QCardSection:x["a"],QSpace:C["a"],QBtnDropdown:y["a"],QList:k["a"],QItem:D["a"],QItemSection:S["a"],QIcon:N["a"],QItemLabel:Q["a"],QCardActions:$["a"]}),I()(A,"directives",{ClosePopup:_["a"]})},1:function(e,t){}}]);